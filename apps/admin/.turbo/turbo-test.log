yarn run v1.22.22
$ jest
PASS src/utils/__tests__/s3UrlProxy.test.ts
FAIL src/__tests__/hooks/useBrands.test.ts
  ‚óè Test suite failed to run

    TypeError: Cannot read properties of undefined (reading 'displayName')

      21 |   />
      22 | ))
    > 23 | ToastViewport.displayName = ToastPrimitives.Viewport.displayName
         |                                                      ^
      24 |
      25 | const toastVariants = cva(
      26 |   "group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",

      at Object.displayName (src/components/ui/toast.tsx:23:54)
      at Object.<anonymous> (src/components/ui/index.ts:308:16)
      at Object.<anonymous> (src/components/common/ErrorBoundary.tsx:26:13)
      at Object.<anonymous> (src/components/common/index.ts:61:24)
      at Object.<anonymous> (src/hooks/useBrands.ts:13:17)
      at Object.<anonymous> (src/__tests__/hooks/useBrands.test.ts:12:20)

FAIL src/__tests__/integration/AuthFlow.test.tsx
  ‚óè Test suite failed to run

    TypeError: Cannot read properties of undefined (reading 'displayName')

      21 |   />
      22 | ))
    > 23 | ToastViewport.displayName = ToastPrimitives.Viewport.displayName
         |                                                      ^
      24 |
      25 | const toastVariants = cva(
      26 |   "group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",

      at Object.displayName (src/components/ui/toast.tsx:23:54)
      at Object.<anonymous> (src/components/ui/index.ts:308:16)
      at Object.<anonymous> (src/app/page.tsx:14:13)
      at Object.<anonymous> (src/__tests__/integration/AuthFlow.test.tsx:26:54)

PASS src/__tests__/components/Button.test.tsx
FAIL src/__tests__/pages/Dashboard.test.tsx
  ‚óè Test suite failed to run

    TypeError: Cannot read properties of undefined (reading 'displayName')

      21 |   />
      22 | ))
    > 23 | ToastViewport.displayName = ToastPrimitives.Viewport.displayName
         |                                                      ^
      24 |
      25 | const toastVariants = cva(
      26 |   "group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",

      at Object.displayName (src/components/ui/toast.tsx:23:54)
      at Object.<anonymous> (src/components/ui/index.ts:308:16)
      at Object.<anonymous> (src/app/page.tsx:14:13)
      at Object.<anonymous> (src/__tests__/pages/Dashboard.test.tsx:31:54)

PASS src/components/transactions/__tests__/TransactionVerificationModal.performance.test.tsx
FAIL src/components/transactions/__tests__/TransactionVerificationModal.optimization.test.tsx
  ‚óè TransactionVerificationModal Optimization Tests ‚Ä∫ React.memo Optimization ‚Ä∫ should be wrapped with React.memo

    expect(received).toBe(expected) // Object.is equality

    Expected: "TransactionVerificationModal"
    Received: undefined

      94 |     it('should be wrapped with React.memo', () => {
      95 |       // Check if the component is wrapped with memo
    > 96 |       expect(TransactionVerificationModal.displayName).toBe('TransactionVerificationModal')
         |                                                        ^
      97 |       expect(TransactionVerificationModal.$$typeof).toBe(Symbol.for('react.memo'))
      98 |     })
      99 |

      at Object.toBe (src/components/transactions/__tests__/TransactionVerificationModal.optimization.test.tsx:96:56)

  ‚óè TransactionVerificationModal Optimization Tests ‚Ä∫ useMemo Optimization ‚Ä∫ should memoize computed values

    TestingLibraryElementError: Unable to find an element with the text: ‚Çπ1,000.00. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33maria-describedby[39m=[32m"verification-modal-description"[39m
          [33maria-labelledby[39m=[32m"verification-modal-title"[39m
          [33mdata-testid[39m=[32m"transaction-verification-modal"[39m
          [33mrole[39m=[32m"dialog"[39m
        [36m>[39m
          [36m<h2[39m
            [33mid[39m=[32m"verification-modal-title"[39m
          [36m>[39m
            [0mVerify receipt[0m
          [36m</h2>[39m
          [36m<p[39m
            [33mid[39m=[32m"verification-modal-description"[39m
          [36m>[39m
            [0mCompare the attached bill with the claim before deciding.[0m
          [36m</p>[39m
          [36m<div>[39m
            [36m<h3>[39m
              [0mUser Information[0m
            [36m</h3>[39m
            [36m<p>[39m
              [0mJohn Doe[0m
            [36m</p>[39m
            [36m<p>[39m
              [0mjohn@example.com[0m
            [36m</p>[39m
            [36m<p>[39m
              [0m9876543210[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<h3>[39m
              [0mTransaction Details[0m
            [36m</h3>[39m
            [36m<p>[39m
              [0m‚Çπ300.00[0m
            [36m</p>[39m
            [36m<span>[39m
              [0mEARN[0m
            [36m</span>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<span>[39m
              [0mRequest 1 of 2[0m
            [36m</span>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Previous request"[39m
            [36m>[39m
              [0mPrevious[0m
            [36m</button>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Next request"[39m
            [36m>[39m
              [0mNext[0m
            [36m</button>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<img[39m
              [33malt[39m=[32m"Receipt image 1 for request tx-123"[39m
              [33msrc[39m=[32m"https://example.com/receipt.jpg"[39m
            [36m/>[39m
            [36m<div[39m
              [33maria-live[39m=[32m"polite"[39m
            [36m>[39m
              [0mImage 1 of 1[0m
            [36m</div>[39m
            [36m<div[39m
              [33mdata-testid[39m=[32m"loading-skeleton"[39m
            [36m>[39m
              [0mLoading image...[0m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<label[39m
              [33mfor[39m=[32m"observed-amount"[39m
            [36m>[39m
              [0mEnter the amount observed on the receipt[0m
            [36m</label>[39m
            [36m<input[39m
              [33maria-label[39m=[32m"Enter the amount observed on the receipt"[39m
              [33mid[39m=[32m"observed-amount"[39m
              [33mtype[39m=[32m"number"[39m
              [33mvalue[39m=[32m""[39m
            [36m/>[39m
            [36m<label[39m
              [33mfor[39m=[32m"receipt-date"[39m
            [36m>[39m
              [0mSelect the date from the receipt[0m
            [36m</label>[39m
            [36m<input[39m
              [33maria-label[39m=[32m"Select the date from the receipt"[39m
              [33mid[39m=[32m"receipt-date"[39m
              [33mtype[39m=[32m"date"[39m
              [33mvalue[39m=[32m""[39m
            [36m/>[39m
            [36m<label[39m
              [33mfor[39m=[32m"verification-checkbox"[39m
            [36m>[39m
              [36m<input[39m
                [33maria-label[39m=[32m"Confirm receipt verification"[39m
                [33mid[39m=[32m"verification-checkbox"[39m
                [33mtype[39m=[32m"checkbox"[39m
              [36m/>[39m
              [0mConfirm receipt verification[0m
            [36m</label>[39m
            [36m<label[39m
              [33mfor[39m=[32m"rejection-note"[39m
            [36m>[39m
              [0mAdd reason for rejection if applicable[0m
            [36m</label>[39m
            [36m<textarea[39m
              [33maria-label[39m=[32m"Add reason for rejection if applicable"[39m
              [33mid[39m=[32m"rejection-note"[39m
            [36m/>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Reject"[39m
              [33mdisabled[39m=[32m""[39m
            [36m>[39m
              [0mReject[0m
            [36m</button>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Approve"[39m
              [33mdisabled[39m=[32m""[39m
            [36m>[39m
              [0mApprove[0m
            [36m</button>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<div>[39m
              [0mUnable to load user information. Please refresh and try again.[0m
            [36m</div>[39m
            [36m<button>[39m
              [0mDismiss[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      149 |       // The computed values should be memoized
      150 |       // We can verify by checking that the component renders correctly
    > 151 |       expect(screen.getByText('‚Çπ1,000.00')).toBeInTheDocument()
          |                     ^
      152 |     })
      153 |
      154 |     it('should handle navigation state efficiently', () => {

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByText (src/components/transactions/__tests__/TransactionVerificationModal.optimization.test.tsx:151:21)

  ‚óè TransactionVerificationModal Optimization Tests ‚Ä∫ Image Loading Optimization ‚Ä∫ should handle image errors gracefully

    TestingLibraryElementError: Unable to find an element with the text: Image failed to load. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33maria-describedby[39m=[32m"verification-modal-description"[39m
          [33maria-labelledby[39m=[32m"verification-modal-title"[39m
          [33mdata-testid[39m=[32m"transaction-verification-modal"[39m
          [33mrole[39m=[32m"dialog"[39m
        [36m>[39m
          [36m<h2[39m
            [33mid[39m=[32m"verification-modal-title"[39m
          [36m>[39m
            [0mVerify receipt[0m
          [36m</h2>[39m
          [36m<p[39m
            [33mid[39m=[32m"verification-modal-description"[39m
          [36m>[39m
            [0mCompare the attached bill with the claim before deciding.[0m
          [36m</p>[39m
          [36m<div>[39m
            [36m<h3>[39m
              [0mUser Information[0m
            [36m</h3>[39m
            [36m<p>[39m
              [0mJohn Doe[0m
            [36m</p>[39m
            [36m<p>[39m
              [0mjohn@example.com[0m
            [36m</p>[39m
            [36m<p>[39m
              [0m9876543210[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<h3>[39m
              [0mTransaction Details[0m
            [36m</h3>[39m
            [36m<p>[39m
              [0m‚Çπ300.00[0m
            [36m</p>[39m
            [36m<span>[39m
              [0mEARN[0m
            [36m</span>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<span>[39m
              [0mRequest 1 of 2[0m
            [36m</span>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Previous request"[39m
            [36m>[39m
              [0mPrevious[0m
            [36m</button>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Next request"[39m
            [36m>[39m
              [0mNext[0m
            [36m</button>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<img[39m
              [33malt[39m=[32m"Receipt image 1 for request tx-123"[39m
              [33msrc[39m=[32m"https://broken-image-url.com/image.jpg"[39m
            [36m/>[39m
            [36m<div[39m
              [33maria-live[39m=[32m"polite"[39m
            [36m>[39m
              [0mImage 1 of 1[0m
            [36m</div>[39m
            [36m<div[39m
              [33mdata-testid[39m=[32m"loading-skeleton"[39m
            [36m>[39m
              [0mLoading image...[0m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<label[39m
              [33mfor[39m=[32m"observed-amount"[39m
            [36m>[39m
              [0mEnter the amount observed on the receipt[0m
            [36m</label>[39m
            [36m<input[39m
              [33maria-label[39m=[32m"Enter the amount observed on the receipt"[39m
              [33mid[39m=[32m"observed-amount"[39m
              [33mtype[39m=[32m"number"[39m
              [33mvalue[39m=[32m""[39m
            [36m/>[39m
            [36m<label[39m
              [33mfor[39m=[32m"receipt-date"[39m
            [36m>[39m
              [0mSelect the date from the receipt[0m
            [36m</label>[39m
            [36m<input[39m
              [33maria-label[39m=[32m"Select the date from the receipt"[39m
              [33mid[39m=[32m"receipt-date"[39m
              [33mtype[39m=[32m"date"[39m
              [33mvalue[39m=[32m""[39m
            [36m/>[39m
            [36m<label[39m
              [33mfor[39m=[32m"verification-checkbox"[39m
            [36m>[39m
              [36m<input[39m
                [33maria-label[39m=[32m"Confirm receipt verification"[39m
                [33mid[39m=[32m"verification-checkbox"[39m
                [33mtype[39m=[32m"checkbox"[39m
              [36m/>[39m
              [0mConfirm receipt verification[0m
            [36m</label>[39m
            [36m<label[39m
              [33mfor[39m=[32m"rejection-note"[39m
            [36m>[39m
              [0mAdd reason for rejection if applicable[0m
            [36m</label>[39m
            [36m<textarea[39m
              [33maria-label[39m=[32m"Add reason for rejection if applicable"[39m
              [33mid[39m=[32m"rejection-note"[39m
            [36m/>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Reject"[39m
              [33mdisabled[39m=[32m""[39m
            [36m>[39m
              [0mReject[0m
            [36m</button>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Approve"[39m
              [33mdisabled[39m=[32m""[39m
            [36m>[39m
              [0mApprove[0m
            [36m</button>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<div>[39m
              [0mUnable to load user information. Please refresh and try again.[0m
            [36m</div>[39m
            [36m<button>[39m
              [0mDismiss[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      196 |       
      197 |       // Should handle broken images gracefully
    > 198 |       expect(screen.getByText('Image failed to load')).toBeInTheDocument()
          |                     ^
      199 |     })
      200 |   })
      201 |

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByText (src/components/transactions/__tests__/TransactionVerificationModal.optimization.test.tsx:198:21)

  ‚óè TransactionVerificationModal Optimization Tests ‚Ä∫ Keyboard Navigation Optimization ‚Ä∫ should handle keyboard events efficiently

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

      210 |       // Test keyboard shortcuts
      211 |       fireEvent.keyDown(modal, { key: 'Escape' })
    > 212 |       expect(defaultProps.onClose).toHaveBeenCalled()
          |                                    ^
      213 |     })
      214 |   })
      215 |

      at Object.toHaveBeenCalled (src/components/transactions/__tests__/TransactionVerificationModal.optimization.test.tsx:212:36)

  ‚óè TransactionVerificationModal Optimization Tests ‚Ä∫ Form Validation Optimization ‚Ä∫ should validate form efficiently

    expect(element).toBeEnabled()

    Received element is not enabled:
      <button aria-label="Approve" disabled="" />

      230 |       
      231 |       // Should be enabled
    > 232 |       expect(approveButton).toBeEnabled()
          |                             ^
      233 |     })
      234 |   })
      235 |

      at Object.toBeEnabled (src/components/transactions/__tests__/TransactionVerificationModal.optimization.test.tsx:232:29)

FAIL src/components/transactions/__tests__/TransactionVerificationModal.test.tsx
  ‚óè TransactionVerificationModal ‚Ä∫ Rendering ‚Ä∫ displays transaction information correctly

    TestingLibraryElementError: Unable to find an element with the display value: 1000.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33maria-describedby[39m=[32m"verification-modal-description"[39m
          [33maria-labelledby[39m=[32m"verification-modal-title"[39m
          [33mdata-testid[39m=[32m"transaction-verification-modal"[39m
          [33mrole[39m=[32m"dialog"[39m
        [36m>[39m
          [36m<h2[39m
            [33mid[39m=[32m"verification-modal-title"[39m
          [36m>[39m
            [0mVerify receipt[0m
          [36m</h2>[39m
          [36m<p[39m
            [33mid[39m=[32m"verification-modal-description"[39m
          [36m>[39m
            [0mCompare the attached bill with the claim before deciding.[0m
          [36m</p>[39m
          [36m<div>[39m
            [36m<h3>[39m
              [0mUser Information[0m
            [36m</h3>[39m
            [36m<p>[39m
              [0mJohn Doe[0m
            [36m</p>[39m
            [36m<p>[39m
              [0mjohn@example.com[0m
            [36m</p>[39m
            [36m<p>[39m
              [0m9876543210[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<h3>[39m
              [0mTransaction Details[0m
            [36m</h3>[39m
            [36m<p>[39m
              [0m‚Çπ1,000.00[0m
            [36m</p>[39m
            [36m<span>[39m
              [0mEARN[0m
            [36m</span>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<span>[39m
              [0mRequest 1 of 2[0m
            [36m</span>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Previous request"[39m
            [36m>[39m
              [0mPrevious[0m
            [36m</button>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Next request"[39m
            [36m>[39m
              [0mNext[0m
            [36m</button>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<img[39m
              [33malt[39m=[32m"Receipt image 1 for request tx-123"[39m
              [33msrc[39m=[32m"https://example.com/receipt.jpg"[39m
            [36m/>[39m
            [36m<div[39m
              [33maria-live[39m=[32m"polite"[39m
            [36m>[39m
              [0mImage 1 of 1[0m
            [36m</div>[39m
            [36m<div[39m
              [33mdata-testid[39m=[32m"loading-skeleton"[39m
            [36m>[39m
              [0mLoading image...[0m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<label[39m
              [33mfor[39m=[32m"observed-amount"[39m
            [36m>[39m
              [0mEnter the amount observed on the receipt[0m
            [36m</label>[39m
            [36m<input[39m
              [33maria-label[39m=[32m"Enter the amount observed on the receipt"[39m
              [33mid[39m=[32m"observed-amount"[39m
              [33mtype[39m=[32m"number"[39m
              [33mvalue[39m=[32m""[39m
            [36m/>[39m
            [36m<label[39m
              [33mfor[39m=[32m"receipt-date"[39m
            [36m>[39m
              [0mSelect the date from the receipt[0m
            [36m</label>[39m
            [36m<input[39m
              [33maria-label[39m=[32m"Select the date from the receipt"[39m
              [33mid[39m=[32m"receipt-date"[39m
              [33mtype[39m=[32m"date"[39m
              [33mvalue[39m=[32m""[39m
            [36m/>[39m
            [36m<label[39m
              [33mfor[39m=[32m"verification-checkbox"[39m
            [36m>[39m
              [36m<input[39m
                [33maria-label[39m=[32m"Confirm receipt verification"[39m
                [33mid[39m=[32m"verification-checkbox"[39m
                [33mtype[39m=[32m"checkbox"[39m
              [36m/>[39m
              [0mConfirm receipt verification[0m
            [36m</label>[39m
            [36m<label[39m
              [33mfor[39m=[32m"rejection-note"[39m
            [36m>[39m
              [0mAdd reason for rejection if applicable[0m
            [36m</label>[39m
            [36m<textarea[39m
              [33maria-label[39m=[32m"Add reason for rejection if applicable"[39m
              [33mid[39m=[32m"rejection-note"[39m
            [36m/>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Reject"[39m
              [33mdisabled[39m=[32m""[39m
            [36m>[39m
              [0mReject[0m
            [36m</button>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Approve"[39m
              [33mdisabled[39m=[32m""[39m
            [36m>[39m
              [0mApprove[0m
            [36m</button>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<div>[39m
              [0mUnable to load user information. Please refresh and try again.[0m
            [36m</div>[39m
            [36m<button>[39m
              [0mDismiss[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      129 |       
      130 |       expect(screen.getByText('‚Çπ1,000.00')).toBeInTheDocument()
    > 131 |       expect(screen.getByDisplayValue('1000')).toBeInTheDocument()
          |                     ^
      132 |       expect(screen.getByDisplayValue('2024-01-15')).toBeInTheDocument()
      133 |     })
      134 |   })

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByDisplayValue (src/components/transactions/__tests__/TransactionVerificationModal.test.tsx:131:21)

  ‚óè TransactionVerificationModal ‚Ä∫ Form Validation ‚Ä∫ requires observed amount to be entered

    expect(element).toBeEnabled()

    Received element is not enabled:
      <button aria-label="Approve" disabled="" />

      150 |       await user.click(verificationCheckbox)
      151 |       
    > 152 |       expect(approveButton).toBeEnabled()
          |                             ^
      153 |     })
      154 |
      155 |     it('requires receipt date to be selected', async () => {

      at Object.toBeEnabled (src/components/transactions/__tests__/TransactionVerificationModal.test.tsx:152:29)

  ‚óè TransactionVerificationModal ‚Ä∫ Navigation ‚Ä∫ navigates between requests using arrow buttons

    TestingLibraryElementError: Unable to find an element with the text: Request 2 of 2. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33maria-describedby[39m=[32m"verification-modal-description"[39m
          [33maria-labelledby[39m=[32m"verification-modal-title"[39m
          [33mdata-testid[39m=[32m"transaction-verification-modal"[39m
          [33mrole[39m=[32m"dialog"[39m
        [36m>[39m
          [36m<h2[39m
            [33mid[39m=[32m"verification-modal-title"[39m
          [36m>[39m
            [0mVerify receipt[0m
          [36m</h2>[39m
          [36m<p[39m
            [33mid[39m=[32m"verification-modal-description"[39m
          [36m>[39m
            [0mCompare the attached bill with the claim before deciding.[0m
          [36m</p>[39m
          [36m<div>[39m
            [36m<h3>[39m
              [0mUser Information[0m
            [36m</h3>[39m
            [36m<p>[39m
              [0mJohn Doe[0m
            [36m</p>[39m
            [36m<p>[39m
              [0mjohn@example.com[0m
            [36m</p>[39m
            [36m<p>[39m
              [0m9876543210[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<h3>[39m
              [0mTransaction Details[0m
            [36m</h3>[39m
            [36m<p>[39m
              [0m‚Çπ1,000.00[0m
            [36m</p>[39m
            [36m<span>[39m
              [0mEARN[0m
            [36m</span>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<span>[39m
              [0mRequest 1 of 2[0m
            [36m</span>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Previous request"[39m
            [36m>[39m
              [0mPrevious[0m
            [36m</button>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Next request"[39m
            [36m>[39m
              [0mNext[0m
            [36m</button>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<img[39m
              [33malt[39m=[32m"Receipt image 1 for request tx-123"[39m
              [33msrc[39m=[32m"https://example.com/receipt.jpg"[39m
            [36m/>[39m
            [36m<div[39m
              [33maria-live[39m=[32m"polite"[39m
            [36m>[39m
              [0mImage 1 of 1[0m
            [36m</div>[39m
            [36m<div[39m
              [33mdata-testid[39m=[32m"loading-skeleton"[39m
            [36m>[39m
              [0mLoading image...[0m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<label[39m
              [33mfor[39m=[32m"observed-amount"[39m
            [36m>[39m
              [0mEnter the amount observed on the receipt[0m
            [36m</label>[39m
            [36m<input[39m
              [33maria-label[39m=[32m"Enter the amount observed on the receipt"[39m
              [33mid[39m=[32m"observed-amount"[39m
              [33mtype[39m=[32m"number"[39m
              [33mvalue[39m=[32m""[39m
            [36m/>[39m
            [36m<label[39m
              [33mfor[39m=[32m"receipt-date"[39m
            [36m>[39m
              [0mSelect the date from the receipt[0m
            [36m</label>[39m
            [36m<input[39m
              [33maria-label[39m=[32m"Select the date from the receipt"[39m
              [33mid[39m=[32m"receipt-date"[39m
              [33mtype[39m=[32m"date"[39m
              [33mvalue[39m=[32m""[39m
            [36m/>[39m
            [36m<label[39m
              [33mfor[39m=[32m"verification-checkbox"[39m
            [36m>[39m
              [36m<input[39m
                [33maria-label[39m=[32m"Confirm receipt verification"[39m
                [33mid[39m=[32m"verification-checkbox"[39m
                [33mtype[39m=[32m"checkbox"[39m
              [36m/>[39m
              [0mConfirm receipt verification[0m
            [36m</label>[39m
            [36m<label[39m
              [33mfor[39m=[32m"rejection-note"[39m
            [36m>[39m
              [0mAdd reason for rejection if applicable[0m
            [36m</label>[39m
            [36m<textarea[39m
              [33maria-label[39m=[32m"Add reason for rejection if applicable"[39m
              [33mid[39m=[32m"rejection-note"[39m
            [36m/>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Reject"[39m
              [33mdisabled[39m=[32m""[39m
            [36m>[39m
              [0mReject[0m
            [36m</button>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Approve"[39m
              [33mdisabled[39m=[32m""[39m
            [36m>[39m
              [0mApprove[0m
            [36m</button>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<div>[39m
              [0mUnable to load user information. Please refresh and try again.[0m
            [36m</div>[39m
            [36m<button>[39m
              [0mDismiss[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      249 |       await user.click(nextButton)
      250 |       
    > 251 |       expect(screen.getByText('Request 2 of 2')).toBeInTheDocument()
          |                     ^
      252 |       expect(screen.getByText('REDEEM')).toBeInTheDocument()
      253 |     })
      254 |

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByText (src/components/transactions/__tests__/TransactionVerificationModal.test.tsx:251:21)

  ‚óè TransactionVerificationModal ‚Ä∫ Navigation ‚Ä∫ navigates between requests using keyboard shortcuts

    TestingLibraryElementError: Unable to find an element with the text: Request 2 of 2. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33maria-describedby[39m=[32m"verification-modal-description"[39m
          [33maria-labelledby[39m=[32m"verification-modal-title"[39m
          [33mdata-testid[39m=[32m"transaction-verification-modal"[39m
          [33mrole[39m=[32m"dialog"[39m
        [36m>[39m
          [36m<h2[39m
            [33mid[39m=[32m"verification-modal-title"[39m
          [36m>[39m
            [0mVerify receipt[0m
          [36m</h2>[39m
          [36m<p[39m
            [33mid[39m=[32m"verification-modal-description"[39m
          [36m>[39m
            [0mCompare the attached bill with the claim before deciding.[0m
          [36m</p>[39m
          [36m<div>[39m
            [36m<h3>[39m
              [0mUser Information[0m
            [36m</h3>[39m
            [36m<p>[39m
              [0mJohn Doe[0m
            [36m</p>[39m
            [36m<p>[39m
              [0mjohn@example.com[0m
            [36m</p>[39m
            [36m<p>[39m
              [0m9876543210[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<h3>[39m
              [0mTransaction Details[0m
            [36m</h3>[39m
            [36m<p>[39m
              [0m‚Çπ1,000.00[0m
            [36m</p>[39m
            [36m<span>[39m
              [0mEARN[0m
            [36m</span>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<span>[39m
              [0mRequest 1 of 2[0m
            [36m</span>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Previous request"[39m
            [36m>[39m
              [0mPrevious[0m
            [36m</button>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Next request"[39m
            [36m>[39m
              [0mNext[0m
            [36m</button>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<img[39m
              [33malt[39m=[32m"Receipt image 1 for request tx-123"[39m
              [33msrc[39m=[32m"https://example.com/receipt.jpg"[39m
            [36m/>[39m
            [36m<div[39m
              [33maria-live[39m=[32m"polite"[39m
            [36m>[39m
              [0mImage 1 of 1[0m
            [36m</div>[39m
            [36m<div[39m
              [33mdata-testid[39m=[32m"loading-skeleton"[39m
            [36m>[39m
              [0mLoading image...[0m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<label[39m
              [33mfor[39m=[32m"observed-amount"[39m
            [36m>[39m
              [0mEnter the amount observed on the receipt[0m
            [36m</label>[39m
            [36m<input[39m
              [33maria-label[39m=[32m"Enter the amount observed on the receipt"[39m
              [33mid[39m=[32m"observed-amount"[39m
              [33mtype[39m=[32m"number"[39m
              [33mvalue[39m=[32m""[39m
            [36m/>[39m
            [36m<label[39m
              [33mfor[39m=[32m"receipt-date"[39m
            [36m>[39m
              [0mSelect the date from the receipt[0m
            [36m</label>[39m
            [36m<input[39m
              [33maria-label[39m=[32m"Select the date from the receipt"[39m
              [33mid[39m=[32m"receipt-date"[39m
              [33mtype[39m=[32m"date"[39m
              [33mvalue[39m=[32m""[39m
            [36m/>[39m
            [36m<label[39m
              [33mfor[39m=[32m"verification-checkbox"[39m
            [36m>[39m
              [36m<input[39m
                [33maria-label[39m=[32m"Confirm receipt verification"[39m
                [33mid[39m=[32m"verification-checkbox"[39m
                [33mtype[39m=[32m"checkbox"[39m
              [36m/>[39m
              [0mConfirm receipt verification[0m
            [36m</label>[39m
            [36m<label[39m
              [33mfor[39m=[32m"rejection-note"[39m
            [36m>[39m
              [0mAdd reason for rejection if applicable[0m
            [36m</label>[39m
            [36m<textarea[39m
              [33maria-label[39m=[32m"Add reason for rejection if applicable"[39m
              [33mid[39m=[32m"rejection-note"[39m
            [36m/>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Reject"[39m
              [33mdisabled[39m=[32m""[39m
            [36m>[39m
              [0mReject[0m
            [36m</button>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Approve"[39m
              [33mdisabled[39m=[32m""[39m
            [36m>[39m
              [0mApprove[0m
            [36m</button>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<div>[39m
              [0mUnable to load user information. Please refresh and try again.[0m
            [36m</div>[39m
            [36m<button>[39m
              [0mDismiss[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      264 |       await user.keyboard('{Alt>}{ArrowRight}')
      265 |       
    > 266 |       expect(screen.getByText('Request 2 of 2')).toBeInTheDocument()
          |                     ^
      267 |     })
      268 |   })
      269 |

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByText (src/components/transactions/__tests__/TransactionVerificationModal.test.tsx:266:21)

  ‚óè TransactionVerificationModal ‚Ä∫ Keyboard Shortcuts ‚Ä∫ closes modal with Escape key

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

      275 |       await user.keyboard('{Escape}')
      276 |       
    > 277 |       expect(defaultProps.onClose).toHaveBeenCalled()
          |                                    ^
      278 |     })
      279 |
      280 |     it('zooms in/out with +/- keys', async () => {

      at Object.toHaveBeenCalled (src/components/transactions/__tests__/TransactionVerificationModal.test.tsx:277:36)

  ‚óè TransactionVerificationModal ‚Ä∫ Form Submission ‚Ä∫ calls onApprove with correct data when approving

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "tx-123", {"adminNotes": "", "observedAmount": 1000, "receiptDate": "2024-01-15", "rejectionNote": "", "verificationConfirmed": true}

    Number of calls: 0

      331 |       await user.click(approveButton)
      332 |       
    > 333 |       expect(onApprove).toHaveBeenCalledWith('tx-123', {
          |                         ^
      334 |         observedAmount: 1000,
      335 |         receiptDate: '2024-01-15',
      336 |         verificationConfirmed: true,

      at Object.toHaveBeenCalledWith (src/components/transactions/__tests__/TransactionVerificationModal.test.tsx:333:25)

  ‚óè TransactionVerificationModal ‚Ä∫ Form Submission ‚Ä∫ calls onReject with correct data when rejecting

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "tx-123", "Amount mismatch"
    Received: {"_reactName": "onClick", "_targetInst": null, "altKey": false, "bubbles": true, "button": 0, "buttons": 0, "cancelable": true, "clientX": 0, "clientY": 0, "ctrlKey": false, "currentTarget": null, "defaultPrevented": false, "detail": 1, "eventPhase": 3, "getModifierState": [Function modifierStateGetter], "isDefaultPrevented": [Function functionThatReturnsFalse], "isPropagationStopped": [Function functionThatReturnsFalse], "isTrusted": false, "metaKey": false, "movementX": 0, "movementY": 0, "nativeEvent": {"isTrusted": false}, "pageX": 0, "pageY": 0, "relatedTarget": null, "screenX": 0, "screenY": 0, "shiftKey": false, "target": <button aria-label="Reject">Reject</button>, "timeStamp": 1759777643893, "type": "click", "view": null}

    Number of calls: 1

      353 |       await user.click(rejectButton)
      354 |       
    > 355 |       expect(onReject).toHaveBeenCalledWith('tx-123', 'Amount mismatch')
          |                        ^
      356 |     })
      357 |
      358 |     it('calls onApproveAndPay for redeem transactions', async () => {

      at Object.toHaveBeenCalledWith (src/components/transactions/__tests__/TransactionVerificationModal.test.tsx:355:24)

  ‚óè TransactionVerificationModal ‚Ä∫ Form Submission ‚Ä∫ calls onApproveAndPay for redeem transactions

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "tx-123", {"adminNotes": "", "observedAmount": 500, "receiptDate": "2024-01-15", "rejectionNote": "", "verificationConfirmed": true}

    Number of calls: 0

      375 |       await user.click(approveAndPayButton)
      376 |       
    > 377 |       expect(onApproveAndPay).toHaveBeenCalledWith('tx-123', {
          |                               ^
      378 |         observedAmount: 500,
      379 |         receiptDate: '2024-01-15',
      380 |         verificationConfirmed: true,

      at Object.toHaveBeenCalledWith (src/components/transactions/__tests__/TransactionVerificationModal.test.tsx:377:31)

  ‚óè TransactionVerificationModal ‚Ä∫ Error Handling ‚Ä∫ shows loading states during form submission

    TestingLibraryElementError: Unable to find an element with the text: Approving.... This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33maria-describedby[39m=[32m"verification-modal-description"[39m
          [33maria-labelledby[39m=[32m"verification-modal-title"[39m
          [33mdata-testid[39m=[32m"transaction-verification-modal"[39m
          [33mrole[39m=[32m"dialog"[39m
        [36m>[39m
          [36m<h2[39m
            [33mid[39m=[32m"verification-modal-title"[39m
          [36m>[39m
            [0mVerify receipt[0m
          [36m</h2>[39m
          [36m<p[39m
            [33mid[39m=[32m"verification-modal-description"[39m
          [36m>[39m
            [0mCompare the attached bill with the claim before deciding.[0m
          [36m</p>[39m
          [36m<div>[39m
            [36m<h3>[39m
              [0mUser Information[0m
            [36m</h3>[39m
            [36m<p>[39m
              [0mJohn Doe[0m
            [36m</p>[39m
            [36m<p>[39m
              [0mjohn@example.com[0m
            [36m</p>[39m
            [36m<p>[39m
              [0m9876543210[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<h3>[39m
              [0mTransaction Details[0m
            [36m</h3>[39m
            [36m<p>[39m
              [0m‚Çπ1,000.00[0m
            [36m</p>[39m
            [36m<span>[39m
              [0mEARN[0m
            [36m</span>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<span>[39m
              [0mRequest 1 of 2[0m
            [36m</span>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Previous request"[39m
            [36m>[39m
              [0mPrevious[0m
            [36m</button>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Next request"[39m
            [36m>[39m
              [0mNext[0m
            [36m</button>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<img[39m
              [33malt[39m=[32m"Receipt image 1 for request tx-123"[39m
              [33msrc[39m=[32m"https://example.com/receipt.jpg"[39m
            [36m/>[39m
            [36m<div[39m
              [33maria-live[39m=[32m"polite"[39m
            [36m>[39m
              [0mImage 1 of 1[0m
            [36m</div>[39m
            [36m<div[39m
              [33mdata-testid[39m=[32m"loading-skeleton"[39m
            [36m>[39m
              [0mLoading image...[0m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<label[39m
              [33mfor[39m=[32m"observed-amount"[39m
            [36m>[39m
              [0mEnter the amount observed on the receipt[0m
            [36m</label>[39m
            [36m<input[39m
              [33maria-label[39m=[32m"Enter the amount observed on the receipt"[39m
              [33mid[39m=[32m"observed-amount"[39m
              [33mtype[39m=[32m"number"[39m
              [33mvalue[39m=[32m"1000"[39m
            [36m/>[39m
            [36m<label[39m
              [33mfor[39m=[32m"receipt-date"[39m
            [36m>[39m
              [0mSelect the date from the receipt[0m
            [36m</label>[39m
            [36m<input[39m
              [33maria-label[39m=[32m"Select the date from the receipt"[39m
              [33mid[39m=[32m"receipt-date"[39m
              [33mtype[39m=[32m"date"[39m
              [33mvalue[39m=[32m""[39m
            [36m/>[39m
            [36m<label[39m
              [33mfor[39m=[32m"verification-checkbox"[39m
            [36m>[39m
              [36m<input[39m
                [33maria-label[39m=[32m"Confirm receipt verification"[39m
                [33mid[39m=[32m"verification-checkbox"[39m
                [33mtype[39m=[32m"checkbox"[39m
              [36m/>[39m
              [0mConfirm receipt verification[0m
            [36m</label>[39m
            [36m<label[39m
              [33mfor[39m=[32m"rejection-note"[39m
            [36m>[39m
              [0mAdd reason for rejection if applicable[0m
            [36m</label>[39m
            [36m<textarea[39m
              [33maria-label[39m=[32m"Add reason for rejection if applicable"[39m
              [33mid[39m=[32m"rejection-note"[39m
            [36m/>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Reject"[39m
              [33mdisabled[39m=[32m""[39m
            [36m>[39m
              [0mReject[0m
            [36m</button>[39m
            [36m<button[39m
              [33maria-label[39m=[32m"Approve"[39m
              [33mdisabled[39m=[32m""[39m
            [36m>[39m
              [0mApprove[0m
            [36m</button>[39m
          [36m</div>[39m
          [36m<div>[39m
            [36m<div>[39m
              [0mUnable to load user information. Please refresh and try again.[0m
            [36m</div>[39m
            [36m<button>[39m
              [0mDismiss[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      432 |       
      433 |       // Check loading state
    > 434 |       expect(screen.getByText('Approving...')).toBeInTheDocument()
          |                     ^
      435 |       expect(approveButton).toBeDisabled()
      436 |     })
      437 |   })

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByText (src/components/transactions/__tests__/TransactionVerificationModal.test.tsx:434:21)

  ‚óè TransactionVerificationModal ‚Ä∫ Accessibility ‚Ä∫ supports keyboard navigation

    expect(element).toHaveFocus()

    Expected element with focus:
      <button aria-label="Reject" disabled="">Reject</button>
    Received element with focus:
      <button aria-label="Previous request">Previous</button>

      454 |       // Tab through focusable elements
      455 |       await user.tab()
    > 456 |       expect(screen.getByRole('button', { name: /reject/i })).toHaveFocus()
          |                                                               ^
      457 |       
      458 |       await user.tab()
      459 |       expect(screen.getByRole('button', { name: /approve/i })).toHaveFocus()

      at Object.toHaveFocus (src/components/transactions/__tests__/TransactionVerificationModal.test.tsx:456:63)

Test Suites: 5 failed, 3 passed, 8 total
Tests:       15 failed, 47 passed, 62 total
Snapshots:   0 total
Time:        2.626 s, estimated 3 s
Ran all test suites.
error Command failed with exit code 1.
info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.
